{"ast":null,"code":"'use strict';\n\nvar __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n    };\n    return extendStatics(d, b);\n  };\n  return function (d, b) {\n    if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n    extendStatics(d, b);\n    function __() {\n      this.constructor = d;\n    }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\nvar __read = this && this.__read || function (o, n) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n  if (!m) return o;\n  var i = m.call(o),\n    r,\n    ar = [],\n    e;\n  try {\n    while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n  } catch (error) {\n    e = {\n      error: error\n    };\n  } finally {\n    try {\n      if (r && !r.done && (m = i[\"return\"])) m.call(i);\n    } finally {\n      if (e) throw e.error;\n    }\n  }\n  return ar;\n};\nvar __spreadArray = this && this.__spreadArray || function (to, from) {\n  for (var i = 0, il = from.length, j = to.length; i < il; i++, j++) to[j] = from[i];\n  return to;\n};\nvar EventEmitter = require('./eventemitter');\nvar RemoteAudioTrack = require('./media/track/remoteaudiotrack');\nvar RemoteAudioTrackPublication = require('./media/track/remoteaudiotrackpublication');\nvar RemoteDataTrack = require('./media/track/remotedatatrack');\nvar RemoteDataTrackPublication = require('./media/track/remotedatatrackpublication');\nvar RemoteVideoTrack = require('./media/track/remotevideotrack');\nvar RemoteVideoTrackPublication = require('./media/track/remotevideotrackpublication');\nvar util = require('./util');\nvar nInstances = 0;\n/**\n * {@link NetworkQualityLevel} is a value from 0–5, inclusive, representing the\n * quality of a network connection.\n * @typedef {number} NetworkQualityLevel\n */\n/**\n * @extends EventEmitter\n * @property {Map<Track.SID, AudioTrackPublication>} audioTracks -\n *    The {@link Participant}'s {@link AudioTrackPublication}s\n * @property {Map<Track.SID, DataTrackPublication>} dataTracks -\n *    The {@link Participant}'s {@link DataTrackPublication}s.\n * @property {Participant.Identity} identity - The identity of the {@link Participant}\n * @property {?NetworkQualityLevel} networkQualityLevel - The\n *    {@link Participant}'s current {@link NetworkQualityLevel}, if any\n * @property {?NetworkQualityStats} networkQualityStats - The\n *    {@link Participant}'s current {@link NetworkQualityStats}, if any\n * @property {Participant.SID} sid - The {@link Participant}'s SID\n * @property {string} state - \"connected\", \"disconnected\" or \"reconnecting\"\n * @property {Map<Track.SID, TrackPublication>} tracks -\n *    The {@link Participant}'s {@link TrackPublication}s\n * @property {Map<Track.SID, VideoTrackPublication>} videoTracks -\n *    The {@link Participant}'s {@link VideoTrackPublication}s\n * @emits Participant#disconnected\n * @emits Participant#networkQualityLevelChanged\n * @emits Participant#reconnected\n * @emits Participant#reconnecting\n * @emits Participant#trackDimensionsChanged\n * @emits Participant#trackStarted\n */\nvar Participant = /** @class */function (_super) {\n  __extends(Participant, _super);\n  /**\n   * Construct a {@link Participant}.\n   * @param {ParticipantSignaling} signaling\n   * @param {object} [options]\n   */\n  function Participant(signaling, options) {\n    var _this = _super.call(this) || this;\n    options = Object.assign({\n      RemoteAudioTrack: RemoteAudioTrack,\n      RemoteAudioTrackPublication: RemoteAudioTrackPublication,\n      RemoteDataTrack: RemoteDataTrack,\n      RemoteDataTrackPublication: RemoteDataTrackPublication,\n      RemoteVideoTrack: RemoteVideoTrack,\n      RemoteVideoTrackPublication: RemoteVideoTrackPublication,\n      tracks: []\n    }, options);\n    var indexed = indexTracksById(options.tracks);\n    var log = options.log.createLog('default', _this);\n    var audioTracks = new Map(indexed.audioTracks);\n    var dataTracks = new Map(indexed.dataTracks);\n    var tracks = new Map(indexed.tracks);\n    var videoTracks = new Map(indexed.videoTracks);\n    Object.defineProperties(_this, {\n      _RemoteAudioTrack: {\n        value: options.RemoteAudioTrack\n      },\n      _RemoteAudioTrackPublication: {\n        value: options.RemoteAudioTrackPublication\n      },\n      _RemoteDataTrack: {\n        value: options.RemoteDataTrack\n      },\n      _RemoteDataTrackPublication: {\n        value: options.RemoteDataTrackPublication\n      },\n      _RemoteVideoTrack: {\n        value: options.RemoteVideoTrack\n      },\n      _RemoteVideoTrackPublication: {\n        value: options.RemoteVideoTrackPublication\n      },\n      _audioTracks: {\n        value: audioTracks\n      },\n      _dataTracks: {\n        value: dataTracks\n      },\n      _instanceId: {\n        value: ++nInstances\n      },\n      _clientTrackSwitchOffControl: {\n        value: options.clientTrackSwitchOffControl\n      },\n      _contentPreferencesMode: {\n        value: options.contentPreferencesMode\n      },\n      _log: {\n        value: log\n      },\n      _signaling: {\n        value: signaling\n      },\n      _tracks: {\n        value: tracks\n      },\n      _trackEventReemitters: {\n        value: new Map()\n      },\n      _trackPublicationEventReemitters: {\n        value: new Map()\n      },\n      _trackSignalingUpdatedEventCallbacks: {\n        value: new Map()\n      },\n      _videoTracks: {\n        value: videoTracks\n      },\n      audioTracks: {\n        enumerable: true,\n        value: new Map()\n      },\n      dataTracks: {\n        enumerable: true,\n        value: new Map()\n      },\n      identity: {\n        enumerable: true,\n        get: function () {\n          return signaling.identity;\n        }\n      },\n      networkQualityLevel: {\n        enumerable: true,\n        get: function () {\n          return signaling.networkQualityLevel;\n        }\n      },\n      networkQualityStats: {\n        enumerable: true,\n        get: function () {\n          return signaling.networkQualityStats;\n        }\n      },\n      sid: {\n        enumerable: true,\n        get: function () {\n          return signaling.sid;\n        }\n      },\n      state: {\n        enumerable: true,\n        get: function () {\n          return signaling.state;\n        }\n      },\n      tracks: {\n        enumerable: true,\n        value: new Map()\n      },\n      videoTracks: {\n        enumerable: true,\n        value: new Map()\n      },\n      _MediaStream: {\n        value: options.MediaStream\n      },\n      _mapMediaElement: {\n        value: options.mapMediaElement\n      },\n      _disposeMediaElement: {\n        value: options.disposeMediaElement\n      }\n    });\n    _this._tracks.forEach(reemitTrackEvents.bind(null, _this));\n    signaling.on('networkQualityLevelChanged', function () {\n      return _this.emit('networkQualityLevelChanged', _this.networkQualityLevel, _this.networkQualityStats && (_this.networkQualityStats.audio || _this.networkQualityStats.video) ? _this.networkQualityStats : null);\n    });\n    reemitSignalingStateChangedEvents(_this, signaling);\n    log.info(\"Created a new Participant\" + (_this.identity ? \": \" + _this.identity : ''));\n    return _this;\n  }\n  /**\n   * Get the {@link RemoteTrack} events to re-emit.\n   * @private\n   * @returns {Array<Array<string>>} events\n   */\n  Participant.prototype._getTrackEvents = function () {\n    return [['dimensionsChanged', 'trackDimensionsChanged'], ['message', 'trackMessage'], ['started', 'trackStarted']];\n  };\n  /**\n   * @private\n   */\n  Participant.prototype._getTrackPublicationEvents = function () {\n    return [];\n  };\n  Participant.prototype.toString = function () {\n    return \"[Participant #\" + this._instanceId + \": \" + this.sid + \"]\";\n  };\n  /**\n   * @private\n   * @param {RemoteTrack} track\n   * @param {Track.ID} id\n   * @returns {?RemoteTrack}\n   */\n  Participant.prototype._addTrack = function (track, id) {\n    var log = this._log;\n    if (this._tracks.has(id)) {\n      return null;\n    }\n    this._tracks.set(id, track);\n    var tracksByKind = {\n      audio: this._audioTracks,\n      video: this._videoTracks,\n      data: this._dataTracks\n    }[track.kind];\n    tracksByKind.set(id, track);\n    reemitTrackEvents(this, track, id);\n    log.info(\"Added a new \" + util.trackClass(track) + \":\", id);\n    log.debug(util.trackClass(track) + \":\", track);\n    return track;\n  };\n  /**\n   * @private\n   * @param {RemoteTrackPublication} publication\n   * @returns {?RemoteTrackPublication}\n   */\n  Participant.prototype._addTrackPublication = function (publication) {\n    var log = this._log;\n    if (this.tracks.has(publication.trackSid)) {\n      return null;\n    }\n    this.tracks.set(publication.trackSid, publication);\n    var trackPublicationsByKind = {\n      audio: this.audioTracks,\n      data: this.dataTracks,\n      video: this.videoTracks\n    }[publication.kind];\n    trackPublicationsByKind.set(publication.trackSid, publication);\n    reemitTrackPublicationEvents(this, publication);\n    log.info(\"Added a new \" + util.trackPublicationClass(publication) + \":\", publication.trackSid);\n    log.debug(util.trackPublicationClass(publication) + \":\", publication);\n    return publication;\n  };\n  /**\n   * @private\n   */\n  Participant.prototype._handleTrackSignalingEvents = function () {\n    var _a = this,\n      log = _a._log,\n      clientTrackSwitchOffControl = _a._clientTrackSwitchOffControl,\n      contentPreferencesMode = _a._contentPreferencesMode,\n      MediaStream = _a._MediaStream,\n      mapMediaElement = _a._mapMediaElement,\n      disposeMediaElement = _a._disposeMediaElement;\n    var self = this;\n    if (this.state === 'disconnected') {\n      return;\n    }\n    var RemoteAudioTrack = this._RemoteAudioTrack;\n    var RemoteAudioTrackPublication = this._RemoteAudioTrackPublication;\n    var RemoteVideoTrack = this._RemoteVideoTrack;\n    var RemoteVideoTrackPublication = this._RemoteVideoTrackPublication;\n    var RemoteDataTrack = this._RemoteDataTrack;\n    var RemoteDataTrackPublication = this._RemoteDataTrackPublication;\n    var participantSignaling = this._signaling;\n    function trackSignalingAdded(signaling) {\n      var RemoteTrackPublication = {\n        audio: RemoteAudioTrackPublication,\n        data: RemoteDataTrackPublication,\n        video: RemoteVideoTrackPublication\n      }[signaling.kind];\n      var publication = new RemoteTrackPublication(signaling, {\n        log: log\n      });\n      self._addTrackPublication(publication);\n      var isSubscribed = signaling.isSubscribed;\n      if (isSubscribed) {\n        trackSignalingSubscribed(signaling);\n      }\n      self._trackSignalingUpdatedEventCallbacks.set(signaling.sid, function () {\n        if (isSubscribed !== signaling.isSubscribed) {\n          isSubscribed = signaling.isSubscribed;\n          if (isSubscribed) {\n            trackSignalingSubscribed(signaling);\n            return;\n          }\n          trackSignalingUnsubscribed(signaling);\n        }\n      });\n      signaling.on('updated', self._trackSignalingUpdatedEventCallbacks.get(signaling.sid));\n    }\n    function trackSignalingRemoved(signaling) {\n      if (signaling.isSubscribed) {\n        signaling.setTrackTransceiver(null);\n      }\n      var updated = self._trackSignalingUpdatedEventCallbacks.get(signaling.sid);\n      if (updated) {\n        signaling.removeListener('updated', updated);\n        self._trackSignalingUpdatedEventCallbacks.delete(signaling.sid);\n      }\n      var publication = self.tracks.get(signaling.sid);\n      if (publication) {\n        self._removeTrackPublication(publication);\n      }\n    }\n    function trackSignalingSubscribed(signaling) {\n      var isEnabled = signaling.isEnabled,\n        name = signaling.name,\n        kind = signaling.kind,\n        sid = signaling.sid,\n        trackTransceiver = signaling.trackTransceiver,\n        isSwitchedOff = signaling.isSwitchedOff;\n      var RemoteTrack = {\n        audio: RemoteAudioTrack,\n        video: RemoteVideoTrack,\n        data: RemoteDataTrack\n      }[kind];\n      var publication = self.tracks.get(sid);\n      // NOTE(mroberts): It should never be the case that the TrackSignaling and\n      // MediaStreamTrack or DataTrackReceiver kinds disagree; however, just in\n      // case, we handle it here.\n      if (!RemoteTrack || kind !== trackTransceiver.kind) {\n        return;\n      }\n      var options = {\n        log: log,\n        name: name,\n        clientTrackSwitchOffControl: clientTrackSwitchOffControl,\n        contentPreferencesMode: contentPreferencesMode,\n        mapMediaElement: mapMediaElement,\n        disposeMediaElement: disposeMediaElement\n      };\n      if (MediaStream) {\n        options.MediaStream = MediaStream;\n      }\n      var setPriority = function (newPriority) {\n        return participantSignaling.updateSubscriberTrackPriority(sid, newPriority);\n      };\n      var setRenderHint = function (renderHint) {\n        if (signaling.isSubscribed) {\n          participantSignaling.updateTrackRenderHint(sid, renderHint);\n        }\n      };\n      var track = kind === 'data' ? new RemoteTrack(sid, trackTransceiver, options) : new RemoteTrack(sid, trackTransceiver, isEnabled, isSwitchedOff, setPriority, setRenderHint, options);\n      self._addTrack(track, publication, trackTransceiver.id);\n    }\n    function trackSignalingUnsubscribed(signaling) {\n      var _a = __read(Array.from(self._tracks.entries()).find(function (_a) {\n          var _b = __read(_a, 2),\n            track = _b[1];\n          return track.sid === signaling.sid;\n        }), 2),\n        id = _a[0],\n        track = _a[1];\n      var publication = self.tracks.get(signaling.sid);\n      if (track) {\n        self._removeTrack(track, publication, id);\n      }\n    }\n    participantSignaling.on('trackAdded', trackSignalingAdded);\n    participantSignaling.on('trackRemoved', trackSignalingRemoved);\n    participantSignaling.tracks.forEach(trackSignalingAdded);\n    participantSignaling.on('stateChanged', function stateChanged(state) {\n      if (state === 'disconnected') {\n        log.debug('Removing event listeners');\n        participantSignaling.removeListener('stateChanged', stateChanged);\n        participantSignaling.removeListener('trackAdded', trackSignalingAdded);\n        participantSignaling.removeListener('trackRemoved', trackSignalingRemoved);\n      } else if (state === 'connected') {\n        // NOTE(mmalavalli): Any transition to \"connected\" here is a result of\n        // successful signaling reconnection, and not a first-time establishment\n        // of the signaling connection.\n        log.info('reconnected');\n        // NOTE(mpatwardhan): `stateChanged` can get emitted with StateMachine locked.\n        // Do not signal  public events synchronously with lock held.\n        setTimeout(function () {\n          return self.emit('reconnected');\n        }, 0);\n      }\n    });\n  };\n  /**\n   * @private\n   * @param {RemoteTrack} track\n   * @param {Track.ID} id\n   * @returns {?RemoteTrack}\n   */\n  Participant.prototype._removeTrack = function (track, id) {\n    if (!this._tracks.has(id)) {\n      return null;\n    }\n    this._tracks.delete(id);\n    var tracksByKind = {\n      audio: this._audioTracks,\n      video: this._videoTracks,\n      data: this._dataTracks\n    }[track.kind];\n    tracksByKind.delete(id);\n    var reemitters = this._trackEventReemitters.get(id) || new Map();\n    reemitters.forEach(function (reemitter, event) {\n      track.removeListener(event, reemitter);\n    });\n    var log = this._log;\n    log.info(\"Removed a \" + util.trackClass(track) + \":\", id);\n    log.debug(util.trackClass(track) + \":\", track);\n    return track;\n  };\n  /**\n   * @private\n   * @param {RemoteTrackPublication} publication\n   * @returns {?RemoteTrackPublication}\n   */\n  Participant.prototype._removeTrackPublication = function (publication) {\n    publication = this.tracks.get(publication.trackSid);\n    if (!publication) {\n      return null;\n    }\n    this.tracks.delete(publication.trackSid);\n    var trackPublicationsByKind = {\n      audio: this.audioTracks,\n      data: this.dataTracks,\n      video: this.videoTracks\n    }[publication.kind];\n    trackPublicationsByKind.delete(publication.trackSid);\n    var reemitters = this._trackPublicationEventReemitters.get(publication.trackSid) || new Map();\n    reemitters.forEach(function (reemitter, event) {\n      publication.removeListener(event, reemitter);\n    });\n    var log = this._log;\n    log.info(\"Removed a \" + util.trackPublicationClass(publication) + \":\", publication.trackSid);\n    log.debug(util.trackPublicationClass(publication) + \":\", publication);\n    return publication;\n  };\n  Participant.prototype.toJSON = function () {\n    return util.valueToJSON(this);\n  };\n  return Participant;\n}(EventEmitter);\n/**\n * A {@link Participant.SID} is a 34-character string starting with \"PA\"\n * that uniquely identifies a {@link Participant}.\n * @type string\n * @typedef Participant.SID\n */\n/**\n * A {@link Participant.Identity} is a string that identifies a\n * {@link Participant}. You can think of it like a name.\n * @typedef {string} Participant.Identity\n */\n/**\n * The {@link Participant} has disconnected.\n * @param {Participant} participant - The {@link Participant} that disconnected.\n * @event Participant#disconnected\n */\n/**\n * The {@link Participant}'s {@link NetworkQualityLevel} changed.\n * @param {NetworkQualityLevel} networkQualityLevel - The new\n *   {@link NetworkQualityLevel}\n * @param {?NetworkQualityStats} networkQualityStats - The {@link NetworkQualityStats}\n *   based on which {@link NetworkQualityLevel} is calculated, if any\n * @event Participant#networkQualityLevelChanged\n */\n/**\n * The {@link Participant} has reconnected to the {@link Room} after a signaling connection disruption.\n * @event Participant#reconnected\n */\n/**\n * The {@link Participant} is reconnecting to the {@link Room} after a signaling connection disruption.\n * @event Participant#reconnecting\n */\n/**\n * One of the {@link Participant}'s {@link VideoTrack}'s dimensions changed.\n * @param {VideoTrack} track - The {@link VideoTrack} whose dimensions changed\n * @event Participant#trackDimensionsChanged\n */\n/**\n * One of the {@link Participant}'s {@link Track}s started.\n * @param {Track} track - The {@link Track} that started\n * @event Participant#trackStarted\n */\n/**\n * Indexed {@link Track}s by {@link Track.ID}.\n * @typedef {object} IndexedTracks\n * @property {Array<{0: Track.ID, 1: AudioTrack}>} audioTracks - Indexed\n *   {@link AudioTrack}s\n * @property {Array<{0: Track.ID, 1: DataTrack}>} dataTracks - Indexed\n *   {@link DataTrack}s\n * @property {Array<{0: Track.ID, 1: Track}>} tracks - Indexed {@link Track}s\n * @property {Array<{0: Track.ID, 1: VideoTrack}>} videoTracks - Indexed\n *   {@link VideoTrack}s\n * @private\n */\n/**\n * Index tracks by {@link Track.ID}.\n * @param {Array<Track>} tracks\n * @returns {IndexedTracks}\n * @private\n */\nfunction indexTracksById(tracks) {\n  var indexedTracks = tracks.map(function (track) {\n    return [track.id, track];\n  });\n  var indexedAudioTracks = indexedTracks.filter(function (keyValue) {\n    return keyValue[1].kind === 'audio';\n  });\n  var indexedVideoTracks = indexedTracks.filter(function (keyValue) {\n    return keyValue[1].kind === 'video';\n  });\n  var indexedDataTracks = indexedTracks.filter(function (keyValue) {\n    return keyValue[1].kind === 'data';\n  });\n  return {\n    audioTracks: indexedAudioTracks,\n    dataTracks: indexedDataTracks,\n    tracks: indexedTracks,\n    videoTracks: indexedVideoTracks\n  };\n}\n/**\n * Re-emit {@link ParticipantSignaling} 'stateChanged' events.\n * @param {Participant} participant\n * @param {ParticipantSignaling} signaling\n * @private\n */\nfunction reemitSignalingStateChangedEvents(participant, signaling) {\n  var log = participant._log;\n  if (participant.state === 'disconnected') {\n    return;\n  }\n  // Reemit state transition events from the ParticipantSignaling.\n  signaling.on('stateChanged', function stateChanged(state) {\n    log.debug('Transitioned to state:', state);\n    participant.emit(state, participant);\n    if (state === 'disconnected') {\n      log.debug('Removing Track event reemitters');\n      signaling.removeListener('stateChanged', stateChanged);\n      participant._tracks.forEach(function (track) {\n        var reemitters = participant._trackEventReemitters.get(track.id);\n        if (track && reemitters) {\n          reemitters.forEach(function (reemitter, event) {\n            track.removeListener(event, reemitter);\n          });\n        }\n      });\n      // eslint-disable-next-line no-warning-comments\n      // TODO(joma): Removing this introduced unit test failures in the RemoteParticipant.\n      // Investigate further before removing.\n      signaling.tracks.forEach(function (trackSignaling) {\n        var track = participant._tracks.get(trackSignaling.id);\n        var reemitters = participant._trackEventReemitters.get(trackSignaling.id);\n        if (track && reemitters) {\n          reemitters.forEach(function (reemitter, event) {\n            track.removeListener(event, reemitter);\n          });\n        }\n      });\n      participant._trackEventReemitters.clear();\n      participant.tracks.forEach(function (publication) {\n        participant._trackPublicationEventReemitters.get(publication.trackSid).forEach(function (reemitter, event) {\n          publication.removeListener(event, reemitter);\n        });\n      });\n      participant._trackPublicationEventReemitters.clear();\n    }\n  });\n}\n/**\n * Re-emit {@link Track} events.\n * @param {Participant} participant\n * @param {Track} track\n * @param {Track.ID} id\n * @private\n */\nfunction reemitTrackEvents(participant, track, id) {\n  var trackEventReemitters = new Map();\n  if (participant.state === 'disconnected') {\n    return;\n  }\n  participant._getTrackEvents().forEach(function (eventPair) {\n    var trackEvent = eventPair[0];\n    var participantEvent = eventPair[1];\n    trackEventReemitters.set(trackEvent, function () {\n      var args = [participantEvent].concat([].slice.call(arguments));\n      return participant.emit.apply(participant, __spreadArray([], __read(args)));\n    });\n    track.on(trackEvent, trackEventReemitters.get(trackEvent));\n  });\n  participant._trackEventReemitters.set(id, trackEventReemitters);\n}\n/**\n * Re-emit {@link TrackPublication} events.\n * @private\n * @param {Participant} participant\n * @param {TrackPublication} publication\n */\nfunction reemitTrackPublicationEvents(participant, publication) {\n  var publicationEventReemitters = new Map();\n  if (participant.state === 'disconnected') {\n    return;\n  }\n  participant._getTrackPublicationEvents().forEach(function (_a) {\n    var _b = __read(_a, 2),\n      publicationEvent = _b[0],\n      participantEvent = _b[1];\n    publicationEventReemitters.set(publicationEvent, function () {\n      var args = [];\n      for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n      }\n      participant.emit.apply(participant, __spreadArray(__spreadArray([participantEvent], __read(args)), [publication]));\n    });\n    publication.on(publicationEvent, publicationEventReemitters.get(publicationEvent));\n  });\n  participant._trackPublicationEventReemitters.set(publication.trackSid, publicationEventReemitters);\n}\nmodule.exports = Participant;","map":{"version":3,"names":["EventEmitter","require","RemoteAudioTrack","RemoteAudioTrackPublication","RemoteDataTrack","RemoteDataTrackPublication","RemoteVideoTrack","RemoteVideoTrackPublication","util","nInstances","Participant","_super","__extends","signaling","options","_this","call","Object","assign","tracks","indexed","indexTracksById","log","createLog","audioTracks","Map","dataTracks","videoTracks","defineProperties","_RemoteAudioTrack","value","_RemoteAudioTrackPublication","_RemoteDataTrack","_RemoteDataTrackPublication","_RemoteVideoTrack","_RemoteVideoTrackPublication","_audioTracks","_dataTracks","_instanceId","_clientTrackSwitchOffControl","clientTrackSwitchOffControl","_contentPreferencesMode","contentPreferencesMode","_log","_signaling","_tracks","_trackEventReemitters","_trackPublicationEventReemitters","_trackSignalingUpdatedEventCallbacks","_videoTracks","enumerable","identity","get","networkQualityLevel","networkQualityStats","sid","state","_MediaStream","MediaStream","_mapMediaElement","mapMediaElement","_disposeMediaElement","disposeMediaElement","forEach","reemitTrackEvents","bind","on","emit","audio","video","reemitSignalingStateChangedEvents","info","prototype","_getTrackEvents","_getTrackPublicationEvents","toString","_addTrack","track","id","has","set","tracksByKind","data","kind","trackClass","debug","_addTrackPublication","publication","trackSid","trackPublicationsByKind","reemitTrackPublicationEvents","trackPublicationClass","_handleTrackSignalingEvents","_a","self","participantSignaling","trackSignalingAdded","RemoteTrackPublication","isSubscribed","trackSignalingSubscribed","trackSignalingUnsubscribed","trackSignalingRemoved","setTrackTransceiver","updated","removeListener","delete","_removeTrackPublication","isEnabled","name","trackTransceiver","isSwitchedOff","RemoteTrack","setPriority","newPriority","updateSubscriberTrackPriority","setRenderHint","renderHint","updateTrackRenderHint","__read","Array","from","entries","find","_b","_removeTrack","stateChanged","setTimeout","reemitters","reemitter","event","toJSON","valueToJSON","indexedTracks","map","indexedAudioTracks","filter","keyValue","indexedVideoTracks","indexedDataTracks","participant","trackSignaling","clear","trackEventReemitters","eventPair","trackEvent","participantEvent","args","concat","slice","arguments","apply","__spreadArray","publicationEventReemitters","publicationEvent","_i","length","module","exports"],"sources":["C:\\Users\\gamin\\OneDrive\\Desktop\\Project\\Whiteboard\\live-whiteboard-app\\whiteboard-frontend\\node_modules\\twilio-video\\lib\\participant.js"],"sourcesContent":["'use strict';\n\nconst EventEmitter = require('./eventemitter');\nconst RemoteAudioTrack = require('./media/track/remoteaudiotrack');\nconst RemoteAudioTrackPublication = require('./media/track/remoteaudiotrackpublication');\nconst RemoteDataTrack = require('./media/track/remotedatatrack');\nconst RemoteDataTrackPublication = require('./media/track/remotedatatrackpublication');\nconst RemoteVideoTrack = require('./media/track/remotevideotrack');\nconst RemoteVideoTrackPublication = require('./media/track/remotevideotrackpublication');\nconst util = require('./util');\n\nlet nInstances = 0;\n\n/**\n * {@link NetworkQualityLevel} is a value from 0–5, inclusive, representing the\n * quality of a network connection.\n * @typedef {number} NetworkQualityLevel\n */\n\n/**\n * @extends EventEmitter\n * @property {Map<Track.SID, AudioTrackPublication>} audioTracks -\n *    The {@link Participant}'s {@link AudioTrackPublication}s\n * @property {Map<Track.SID, DataTrackPublication>} dataTracks -\n *    The {@link Participant}'s {@link DataTrackPublication}s.\n * @property {Participant.Identity} identity - The identity of the {@link Participant}\n * @property {?NetworkQualityLevel} networkQualityLevel - The\n *    {@link Participant}'s current {@link NetworkQualityLevel}, if any\n * @property {?NetworkQualityStats} networkQualityStats - The\n *    {@link Participant}'s current {@link NetworkQualityStats}, if any\n * @property {Participant.SID} sid - The {@link Participant}'s SID\n * @property {string} state - \"connected\", \"disconnected\" or \"reconnecting\"\n * @property {Map<Track.SID, TrackPublication>} tracks -\n *    The {@link Participant}'s {@link TrackPublication}s\n * @property {Map<Track.SID, VideoTrackPublication>} videoTracks -\n *    The {@link Participant}'s {@link VideoTrackPublication}s\n * @emits Participant#disconnected\n * @emits Participant#networkQualityLevelChanged\n * @emits Participant#reconnected\n * @emits Participant#reconnecting\n * @emits Participant#trackDimensionsChanged\n * @emits Participant#trackStarted\n */\nclass Participant extends EventEmitter {\n  /**\n   * Construct a {@link Participant}.\n   * @param {ParticipantSignaling} signaling\n   * @param {object} [options]\n   */\n  constructor(signaling, options) {\n    super();\n\n    options = Object.assign({\n      RemoteAudioTrack,\n      RemoteAudioTrackPublication,\n      RemoteDataTrack,\n      RemoteDataTrackPublication,\n      RemoteVideoTrack,\n      RemoteVideoTrackPublication,\n      tracks: []\n    }, options);\n\n    const indexed = indexTracksById(options.tracks);\n    const log = options.log.createLog('default', this);\n    const audioTracks = new Map(indexed.audioTracks);\n    const dataTracks = new Map(indexed.dataTracks);\n    const tracks = new Map(indexed.tracks);\n    const videoTracks = new Map(indexed.videoTracks);\n\n    Object.defineProperties(this, {\n      _RemoteAudioTrack: {\n        value: options.RemoteAudioTrack\n      },\n      _RemoteAudioTrackPublication: {\n        value: options.RemoteAudioTrackPublication\n      },\n      _RemoteDataTrack: {\n        value: options.RemoteDataTrack\n      },\n      _RemoteDataTrackPublication: {\n        value: options.RemoteDataTrackPublication\n      },\n      _RemoteVideoTrack: {\n        value: options.RemoteVideoTrack\n      },\n      _RemoteVideoTrackPublication: {\n        value: options.RemoteVideoTrackPublication\n      },\n      _audioTracks: {\n        value: audioTracks\n      },\n      _dataTracks: {\n        value: dataTracks\n      },\n      _instanceId: {\n        value: ++nInstances\n      },\n      _clientTrackSwitchOffControl: {\n        value: options.clientTrackSwitchOffControl,\n      },\n      _contentPreferencesMode: {\n        value: options.contentPreferencesMode,\n      },\n      _log: {\n        value: log\n      },\n      _signaling: {\n        value: signaling\n      },\n      _tracks: {\n        value: tracks\n      },\n      _trackEventReemitters: {\n        value: new Map()\n      },\n      _trackPublicationEventReemitters: {\n        value: new Map()\n      },\n      _trackSignalingUpdatedEventCallbacks: {\n        value: new Map()\n      },\n      _videoTracks: {\n        value: videoTracks\n      },\n      audioTracks: {\n        enumerable: true,\n        value: new Map()\n      },\n      dataTracks: {\n        enumerable: true,\n        value: new Map()\n      },\n      identity: {\n        enumerable: true,\n        get() {\n          return signaling.identity;\n        }\n      },\n      networkQualityLevel: {\n        enumerable: true,\n        get() {\n          return signaling.networkQualityLevel;\n        }\n      },\n      networkQualityStats: {\n        enumerable: true,\n        get() {\n          return signaling.networkQualityStats;\n        }\n      },\n      sid: {\n        enumerable: true,\n        get() {\n          return signaling.sid;\n        }\n      },\n      state: {\n        enumerable: true,\n        get() {\n          return signaling.state;\n        }\n      },\n      tracks: {\n        enumerable: true,\n        value: new Map()\n      },\n      videoTracks: {\n        enumerable: true,\n        value: new Map()\n      },\n      _MediaStream: {\n        value: options.MediaStream\n      },\n      _mapMediaElement: {\n        value: options.mapMediaElement\n      },\n      _disposeMediaElement: {\n        value: options.disposeMediaElement\n      }\n    });\n\n    this._tracks.forEach(reemitTrackEvents.bind(null, this));\n    signaling.on('networkQualityLevelChanged', () =>\n      this.emit('networkQualityLevelChanged', this.networkQualityLevel,\n        this.networkQualityStats &&\n        (this.networkQualityStats.audio || this.networkQualityStats.video)\n          ? this.networkQualityStats\n          : null));\n    reemitSignalingStateChangedEvents(this, signaling);\n    log.info(`Created a new Participant${this.identity ? `: ${this.identity}` : ''}`);\n  }\n\n  /**\n   * Get the {@link RemoteTrack} events to re-emit.\n   * @private\n   * @returns {Array<Array<string>>} events\n   */\n  _getTrackEvents() {\n    return [\n      ['dimensionsChanged', 'trackDimensionsChanged'],\n      ['message', 'trackMessage'],\n      ['started', 'trackStarted']\n    ];\n  }\n\n  /**\n   * @private\n   */\n  _getTrackPublicationEvents() {\n    return [];\n  }\n\n  toString() {\n    return `[Participant #${this._instanceId}: ${this.sid}]`;\n  }\n\n  /**\n   * @private\n   * @param {RemoteTrack} track\n   * @param {Track.ID} id\n   * @returns {?RemoteTrack}\n   */\n  _addTrack(track, id) {\n    const log = this._log;\n    if (this._tracks.has(id)) {\n      return null;\n    }\n    this._tracks.set(id, track);\n\n    const tracksByKind = {\n      audio: this._audioTracks,\n      video: this._videoTracks,\n      data: this._dataTracks\n    }[track.kind];\n    tracksByKind.set(id, track);\n    reemitTrackEvents(this, track, id);\n\n    log.info(`Added a new ${util.trackClass(track)}:`, id);\n    log.debug(`${util.trackClass(track)}:`, track);\n\n    return track;\n  }\n\n\n  /**\n   * @private\n   * @param {RemoteTrackPublication} publication\n   * @returns {?RemoteTrackPublication}\n   */\n  _addTrackPublication(publication) {\n    const log = this._log;\n    if (this.tracks.has(publication.trackSid)) {\n      return null;\n    }\n    this.tracks.set(publication.trackSid, publication);\n\n    const trackPublicationsByKind = {\n      audio: this.audioTracks,\n      data: this.dataTracks,\n      video: this.videoTracks\n    }[publication.kind];\n    trackPublicationsByKind.set(publication.trackSid, publication);\n    reemitTrackPublicationEvents(this, publication);\n\n    log.info(`Added a new ${util.trackPublicationClass(publication)}:`, publication.trackSid);\n    log.debug(`${util.trackPublicationClass(publication)}:`, publication);\n    return publication;\n  }\n\n  /**\n   * @private\n   */\n  _handleTrackSignalingEvents() {\n    const { _log: log, _clientTrackSwitchOffControl: clientTrackSwitchOffControl, _contentPreferencesMode: contentPreferencesMode, _MediaStream: MediaStream, _mapMediaElement: mapMediaElement, _disposeMediaElement: disposeMediaElement } = this;\n    const self = this;\n\n    if (this.state === 'disconnected') {\n      return;\n    }\n\n    const RemoteAudioTrack = this._RemoteAudioTrack;\n    const RemoteAudioTrackPublication = this._RemoteAudioTrackPublication;\n    const RemoteVideoTrack = this._RemoteVideoTrack;\n    const RemoteVideoTrackPublication = this._RemoteVideoTrackPublication;\n    const RemoteDataTrack = this._RemoteDataTrack;\n    const RemoteDataTrackPublication = this._RemoteDataTrackPublication;\n    const participantSignaling = this._signaling;\n\n    function trackSignalingAdded(signaling) {\n      const RemoteTrackPublication = {\n        audio: RemoteAudioTrackPublication,\n        data: RemoteDataTrackPublication,\n        video: RemoteVideoTrackPublication\n      }[signaling.kind];\n\n      const publication = new RemoteTrackPublication(signaling, { log });\n      self._addTrackPublication(publication);\n\n      let isSubscribed = signaling.isSubscribed;\n      if (isSubscribed) {\n        trackSignalingSubscribed(signaling);\n      }\n\n      self._trackSignalingUpdatedEventCallbacks.set(signaling.sid, () => {\n        if (isSubscribed !== signaling.isSubscribed) {\n          isSubscribed = signaling.isSubscribed;\n          if (isSubscribed) {\n            trackSignalingSubscribed(signaling);\n            return;\n          }\n          trackSignalingUnsubscribed(signaling);\n        }\n      });\n      signaling.on('updated', self._trackSignalingUpdatedEventCallbacks.get(signaling.sid));\n    }\n\n    function trackSignalingRemoved(signaling) {\n      if (signaling.isSubscribed) {\n        signaling.setTrackTransceiver(null);\n      }\n      const updated = self._trackSignalingUpdatedEventCallbacks.get(signaling.sid);\n      if (updated) {\n        signaling.removeListener('updated', updated);\n        self._trackSignalingUpdatedEventCallbacks.delete(signaling.sid);\n      }\n      const publication = self.tracks.get(signaling.sid);\n      if (publication) {\n        self._removeTrackPublication(publication);\n      }\n    }\n\n    function trackSignalingSubscribed(signaling) {\n      const { isEnabled, name, kind, sid, trackTransceiver, isSwitchedOff } = signaling;\n      const RemoteTrack = {\n        audio: RemoteAudioTrack,\n        video: RemoteVideoTrack,\n        data: RemoteDataTrack\n      }[kind];\n\n      const publication = self.tracks.get(sid);\n\n      // NOTE(mroberts): It should never be the case that the TrackSignaling and\n      // MediaStreamTrack or DataTrackReceiver kinds disagree; however, just in\n      // case, we handle it here.\n      if (!RemoteTrack || kind !== trackTransceiver.kind) {\n        return;\n      }\n\n      const options = { log, name, clientTrackSwitchOffControl, contentPreferencesMode, mapMediaElement, disposeMediaElement };\n      if (MediaStream) {\n        options.MediaStream = MediaStream;\n      }\n      const setPriority = newPriority => participantSignaling.updateSubscriberTrackPriority(sid, newPriority);\n      const setRenderHint = renderHint => {\n        if (signaling.isSubscribed) {\n          participantSignaling.updateTrackRenderHint(sid, renderHint);\n        }\n      };\n      const track = kind === 'data'\n        ? new RemoteTrack(sid, trackTransceiver, options)\n        : new RemoteTrack(sid, trackTransceiver, isEnabled, isSwitchedOff, setPriority, setRenderHint, options);\n\n      self._addTrack(track, publication, trackTransceiver.id);\n    }\n\n    function trackSignalingUnsubscribed(signaling) {\n      const [id, track] = Array.from(self._tracks.entries()).find(([, track]) => track.sid === signaling.sid);\n      const publication = self.tracks.get(signaling.sid);\n      if (track) {\n        self._removeTrack(track, publication, id);\n      }\n    }\n\n    participantSignaling.on('trackAdded', trackSignalingAdded);\n    participantSignaling.on('trackRemoved', trackSignalingRemoved);\n\n    participantSignaling.tracks.forEach(trackSignalingAdded);\n\n    participantSignaling.on('stateChanged', function stateChanged(state) {\n      if (state === 'disconnected') {\n        log.debug('Removing event listeners');\n        participantSignaling.removeListener('stateChanged', stateChanged);\n        participantSignaling.removeListener('trackAdded', trackSignalingAdded);\n        participantSignaling.removeListener('trackRemoved', trackSignalingRemoved);\n      } else if (state === 'connected') {\n        // NOTE(mmalavalli): Any transition to \"connected\" here is a result of\n        // successful signaling reconnection, and not a first-time establishment\n        // of the signaling connection.\n        log.info('reconnected');\n\n        // NOTE(mpatwardhan): `stateChanged` can get emitted with StateMachine locked.\n        // Do not signal  public events synchronously with lock held.\n        setTimeout(() => self.emit('reconnected'), 0);\n\n      }\n    });\n  }\n\n  /**\n   * @private\n   * @param {RemoteTrack} track\n   * @param {Track.ID} id\n   * @returns {?RemoteTrack}\n   */\n  _removeTrack(track, id) {\n    if (!this._tracks.has(id)) {\n      return null;\n    }\n    this._tracks.delete(id);\n\n    const tracksByKind = {\n      audio: this._audioTracks,\n      video: this._videoTracks,\n      data: this._dataTracks\n    }[track.kind];\n    tracksByKind.delete(id);\n\n    const reemitters = this._trackEventReemitters.get(id) || new Map();\n    reemitters.forEach((reemitter, event) => {\n      track.removeListener(event, reemitter);\n    });\n\n    const log = this._log;\n    log.info(`Removed a ${util.trackClass(track)}:`, id);\n    log.debug(`${util.trackClass(track)}:`, track);\n    return track;\n  }\n\n  /**\n   * @private\n   * @param {RemoteTrackPublication} publication\n   * @returns {?RemoteTrackPublication}\n   */\n  _removeTrackPublication(publication) {\n    publication = this.tracks.get(publication.trackSid);\n    if (!publication) {\n      return null;\n    }\n    this.tracks.delete(publication.trackSid);\n\n    const trackPublicationsByKind = {\n      audio: this.audioTracks,\n      data: this.dataTracks,\n      video: this.videoTracks\n    }[publication.kind];\n    trackPublicationsByKind.delete(publication.trackSid);\n\n    const reemitters = this._trackPublicationEventReemitters.get(publication.trackSid) || new Map();\n    reemitters.forEach((reemitter, event) => {\n      publication.removeListener(event, reemitter);\n    });\n\n    const log = this._log;\n    log.info(`Removed a ${util.trackPublicationClass(publication)}:`, publication.trackSid);\n    log.debug(`${util.trackPublicationClass(publication)}:`, publication);\n    return publication;\n  }\n\n  toJSON() {\n    return util.valueToJSON(this);\n  }\n}\n\n/**\n * A {@link Participant.SID} is a 34-character string starting with \"PA\"\n * that uniquely identifies a {@link Participant}.\n * @type string\n * @typedef Participant.SID\n */\n\n/**\n * A {@link Participant.Identity} is a string that identifies a\n * {@link Participant}. You can think of it like a name.\n * @typedef {string} Participant.Identity\n */\n\n/**\n * The {@link Participant} has disconnected.\n * @param {Participant} participant - The {@link Participant} that disconnected.\n * @event Participant#disconnected\n */\n\n/**\n * The {@link Participant}'s {@link NetworkQualityLevel} changed.\n * @param {NetworkQualityLevel} networkQualityLevel - The new\n *   {@link NetworkQualityLevel}\n * @param {?NetworkQualityStats} networkQualityStats - The {@link NetworkQualityStats}\n *   based on which {@link NetworkQualityLevel} is calculated, if any\n * @event Participant#networkQualityLevelChanged\n */\n\n/**\n * The {@link Participant} has reconnected to the {@link Room} after a signaling connection disruption.\n * @event Participant#reconnected\n */\n\n/**\n * The {@link Participant} is reconnecting to the {@link Room} after a signaling connection disruption.\n * @event Participant#reconnecting\n */\n\n/**\n * One of the {@link Participant}'s {@link VideoTrack}'s dimensions changed.\n * @param {VideoTrack} track - The {@link VideoTrack} whose dimensions changed\n * @event Participant#trackDimensionsChanged\n */\n\n/**\n * One of the {@link Participant}'s {@link Track}s started.\n * @param {Track} track - The {@link Track} that started\n * @event Participant#trackStarted\n */\n\n/**\n * Indexed {@link Track}s by {@link Track.ID}.\n * @typedef {object} IndexedTracks\n * @property {Array<{0: Track.ID, 1: AudioTrack}>} audioTracks - Indexed\n *   {@link AudioTrack}s\n * @property {Array<{0: Track.ID, 1: DataTrack}>} dataTracks - Indexed\n *   {@link DataTrack}s\n * @property {Array<{0: Track.ID, 1: Track}>} tracks - Indexed {@link Track}s\n * @property {Array<{0: Track.ID, 1: VideoTrack}>} videoTracks - Indexed\n *   {@link VideoTrack}s\n * @private\n */\n\n/**\n * Index tracks by {@link Track.ID}.\n * @param {Array<Track>} tracks\n * @returns {IndexedTracks}\n * @private\n */\nfunction indexTracksById(tracks) {\n  const indexedTracks = tracks.map(track => [track.id, track]);\n  const indexedAudioTracks = indexedTracks.filter(keyValue => keyValue[1].kind === 'audio');\n  const indexedVideoTracks = indexedTracks.filter(keyValue => keyValue[1].kind === 'video');\n  const indexedDataTracks = indexedTracks.filter(keyValue => keyValue[1].kind === 'data');\n\n  return {\n    audioTracks: indexedAudioTracks,\n    dataTracks: indexedDataTracks,\n    tracks: indexedTracks,\n    videoTracks: indexedVideoTracks\n  };\n}\n\n/**\n * Re-emit {@link ParticipantSignaling} 'stateChanged' events.\n * @param {Participant} participant\n * @param {ParticipantSignaling} signaling\n * @private\n */\nfunction reemitSignalingStateChangedEvents(participant, signaling) {\n  const log = participant._log;\n\n  if (participant.state === 'disconnected') {\n    return;\n  }\n\n  // Reemit state transition events from the ParticipantSignaling.\n  signaling.on('stateChanged', function stateChanged(state) {\n    log.debug('Transitioned to state:', state);\n    participant.emit(state, participant);\n    if (state === 'disconnected') {\n      log.debug('Removing Track event reemitters');\n      signaling.removeListener('stateChanged', stateChanged);\n\n      participant._tracks.forEach(track => {\n        const reemitters = participant._trackEventReemitters.get(track.id);\n        if (track && reemitters) {\n          reemitters.forEach((reemitter, event) => {\n            track.removeListener(event, reemitter);\n          });\n        }\n      });\n\n      // eslint-disable-next-line no-warning-comments\n      // TODO(joma): Removing this introduced unit test failures in the RemoteParticipant.\n      // Investigate further before removing.\n      signaling.tracks.forEach(trackSignaling => {\n        const track = participant._tracks.get(trackSignaling.id);\n        const reemitters = participant._trackEventReemitters.get(trackSignaling.id);\n        if (track && reemitters) {\n          reemitters.forEach((reemitter, event) => {\n            track.removeListener(event, reemitter);\n          });\n        }\n      });\n\n      participant._trackEventReemitters.clear();\n\n      participant.tracks.forEach(publication => {\n        participant._trackPublicationEventReemitters.get(publication.trackSid)\n          .forEach((reemitter, event) => {\n            publication.removeListener(event, reemitter);\n          });\n      });\n      participant._trackPublicationEventReemitters.clear();\n    }\n  });\n}\n\n/**\n * Re-emit {@link Track} events.\n * @param {Participant} participant\n * @param {Track} track\n * @param {Track.ID} id\n * @private\n */\nfunction reemitTrackEvents(participant, track, id) {\n  const trackEventReemitters = new Map();\n\n  if (participant.state === 'disconnected') {\n    return;\n  }\n\n  participant._getTrackEvents().forEach(eventPair => {\n    const trackEvent = eventPair[0];\n    const participantEvent = eventPair[1];\n\n    trackEventReemitters.set(trackEvent, function() {\n      const args = [participantEvent].concat([].slice.call(arguments));\n      return participant.emit(...args);\n    });\n\n    track.on(trackEvent, trackEventReemitters.get(trackEvent));\n  });\n\n  participant._trackEventReemitters.set(id, trackEventReemitters);\n}\n\n/**\n * Re-emit {@link TrackPublication} events.\n * @private\n * @param {Participant} participant\n * @param {TrackPublication} publication\n */\nfunction reemitTrackPublicationEvents(participant, publication) {\n  const publicationEventReemitters = new Map();\n\n  if (participant.state === 'disconnected') {\n    return;\n  }\n\n  participant._getTrackPublicationEvents().forEach(([publicationEvent, participantEvent]) => {\n    publicationEventReemitters.set(publicationEvent, (...args) => {\n      participant.emit(participantEvent, ...args, publication);\n    });\n    publication.on(publicationEvent, publicationEventReemitters.get(publicationEvent));\n  });\n\n  participant._trackPublicationEventReemitters.set(publication.trackSid, publicationEventReemitters);\n}\n\nmodule.exports = Participant;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}